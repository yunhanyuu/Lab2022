!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("THREE")):"function"==typeof define&&define.amd?define(["THREE"],e):"object"==typeof exports?exports.THREE_Text2D=e(require("THREE")):t.THREE_Text2D=e(t.THREE)}(self,(function(t){return(()=>{"use strict";var e={320:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasText=void 0;const s=i(824),a=i(593);e.CanvasText=class{constructor(){this.textWidth=null,this.textHeight=null,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}get width(){return this.canvas.width}get height(){return this.canvas.height}drawText(t,e){this.ctx.font=e.font;const i=(0,a.getFontHeight)(e.font),h=(t||"").toString().split("\n");this.textWidth=Math.max.apply(null,h.map((t=>Math.ceil(this.ctx.measureText(t).width)))),this.textHeight=i+i*e.lineHeight*(h.length-1),this.canvas.width=Math.max(2,s.MathUtils.ceilPowerOfTwo(this.textWidth+2*e.horizontalPadding)),this.canvas.height=Math.max(2,s.MathUtils.ceilPowerOfTwo(this.textHeight+2*e.verticalPadding)),this.ctx.font=e.font,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),e.backgroundColor&&(this.ctx.fillStyle=e.backgroundColor,this.ctx.fillRect(0,0,this.textWidth+2*e.horizontalPadding,this.textHeight+2*e.verticalPadding)),this.ctx.fillStyle=e.fillStyle,1===e.align.x?this.ctx.textAlign="left":0===e.align.x?this.ctx.textAlign="center":this.ctx.textAlign="right",this.ctx.textBaseline="top",this.ctx.shadowColor=e.shadowColor,this.ctx.shadowBlur=e.shadowBlur,this.ctx.shadowOffsetX=e.shadowOffsetX,this.ctx.shadowOffsetY=e.shadowOffsetY;const n=this.textWidth*(.5-.5*e.align.x),r=.5*(i*e.lineHeight-i);for(let t=0;t<h.length;t++)this.ctx.fillText(h[t],n+e.horizontalPadding,i*e.lineHeight*t+e.verticalPadding+r);return this.canvas}}},560:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MeshText2D=void 0;const s=i(824),a=i(955);class h extends a.Text2D{constructor(t="",e={}){super(t,e)}raycast(){this.mesh.raycast.apply(this.mesh,arguments)}updateText(){this.cleanUp(),this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle,shadowBlur:this._shadowBlur,shadowColor:this._shadowColor,shadowOffsetX:this._shadowOffsetX,shadowOffsetY:this._shadowOffsetY,lineHeight:this._lineHeight,align:this.align,backgroundColor:this._backgroundColor,horizontalPadding:this._horizontalPadding,verticalPadding:this._verticalPadding}),this.texture=new s.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:(this.material=new s.MeshBasicMaterial({map:this.texture,side:this.side}),this.material.transparent=!0),this.mesh||(this.geometry=new s.PlaneGeometry(this.canvas.width,this.canvas.height),this.mesh=new s.Mesh(this.geometry,this.material),this.add(this.mesh)),this.mesh.position.x=this.canvas.width/2-this.canvas.textWidth/2+this.canvas.textWidth/2*this.align.x,this.mesh.position.y=-this.canvas.height/2+this.canvas.textHeight/2*this.align.y;const t=-this.canvas.width/2,e=this.canvas.width/2,i=this.canvas.height/2,a=-this.canvas.height/2;this.geometry.attributes.position.setXY(0,t,i),this.geometry.attributes.position.setXY(1,e,i),this.geometry.attributes.position.setXY(2,t,a),this.geometry.attributes.position.setXY(3,e,a),this.geometry.attributes.position.needsUpdate=!0}}e.MeshText2D=h},551:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteText2D=void 0;const s=i(824),a=i(955);class h extends a.Text2D{raycast(){return this.sprite.raycast.apply(this.sprite,arguments)}updateText(){this.canvas.drawText(this._text,{font:this._font,fillStyle:this._fillStyle,shadowBlur:this._shadowBlur,shadowColor:this._shadowColor,shadowOffsetX:this._shadowOffsetX,shadowOffsetY:this._shadowOffsetY,lineHeight:this._lineHeight,align:this.align,backgroundColor:this._backgroundColor,horizontalPadding:this._horizontalPadding,verticalPadding:this._verticalPadding}),this.cleanUp(),this.texture=new s.Texture(this.canvas.canvas),this.texture.needsUpdate=!0,this.applyAntiAlias(),this.material?this.material.map=this.texture:this.material=new s.SpriteMaterial({map:this.texture}),this.sprite||(this.sprite=new s.Sprite(this.material),this.add(this.sprite)),this.sprite.scale.set(this.canvas.width,this.canvas.height,1),this.updateAlign()}updateAlign(){this.sprite&&(this.sprite.center.x=(.5-.5*this._align.x)*this.canvas.textWidth/this.canvas.width,this.sprite.center.y=1-(.5*this._align.y+.5)*this.canvas.textHeight/this.canvas.height)}get align(){return this._align}set align(t){this._align.copy(t),this.updateAlign()}}e.SpriteText2D=h},955:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Text2D=void 0;const s=i(824),a=i(593),h=i(320);class n extends s.Object3D{constructor(t="",e={}){super(),this._align=new s.Vector2,this._font=e.font||"30px Arial",this._fillStyle=e.fillStyle||"#FFFFFF",this._shadowColor=e.shadowColor||"rgba(0, 0, 0, 0)",this._shadowBlur=e.shadowBlur||0,this._shadowOffsetX=e.shadowOffsetX||0,this._shadowOffsetY=e.shadowOffsetY||0,this._lineHeight=e.lineHeight||1.2,this._backgroundColor=e.backgroundColor||"transparent",this._horizontalPadding=e.horizontalPadding||0,this._verticalPadding=e.verticalPadding||0,this.canvas=new h.CanvasText,this.align=e.align||a.textAlign.center,this.side=e.side||s.DoubleSide,this.antialias=void 0===e.antialias||e.antialias,this.text=t}get width(){return this.canvas.textWidth}get height(){return this.canvas.textHeight}get text(){return this._text}set text(t){this._text!==t&&(this._text=t,this.updateText())}get font(){return this._font}set font(t){this._font!==t&&(this._font=t,this.updateText())}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle!==t&&(this._fillStyle=t,this.updateText())}get align(){return this._align}set align(t){this._align.copy(t)}cleanUp(){this.texture&&this.texture.dispose()}applyAntiAlias(){!1===this.antialias&&(this.texture.magFilter=s.NearestFilter,this.texture.minFilter=s.LinearMipMapLinearFilter)}}e.Text2D=n},593:(t,e,i)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFontHeight=e.textAlign=void 0;const s=i(824);e.textAlign={center:new s.Vector2(0,0),left:new s.Vector2(1,0),top:new s.Vector2(0,-1),topLeft:new s.Vector2(1,-1),topRight:new s.Vector2(-1,-1),right:new s.Vector2(-1,0),bottom:new s.Vector2(0,1),bottomLeft:new s.Vector2(1,1),bottomRight:new s.Vector2(-1,1)};var a={};e.getFontHeight=function(t){var e=a[t];if(!e){var i=document.getElementsByTagName("body")[0],s=document.createElement("div"),h=document.createTextNode("MÃ‰q");s.appendChild(h),s.setAttribute("style",`font:${t};position:absolute;top:0;left:0`),i.appendChild(s),e=s.offsetHeight,a[t]=e,i.removeChild(s)}return e}},824:e=>{e.exports=t}},i={};function s(t){var a=i[t];if(void 0!==a)return a.exports;var h=i[t]={exports:{}};return e[t](h,h.exports,s),h.exports}var a={};return(()=>{var t=a;Object.defineProperty(t,"__esModule",{value:!0}),t.textAlign=t.MeshText2D=t.SpriteText2D=void 0;var e=s(551);Object.defineProperty(t,"SpriteText2D",{enumerable:!0,get:function(){return e.SpriteText2D}});var i=s(560);Object.defineProperty(t,"MeshText2D",{enumerable:!0,get:function(){return i.MeshText2D}});var h=s(593);Object.defineProperty(t,"textAlign",{enumerable:!0,get:function(){return h.textAlign}})})(),a})()}));